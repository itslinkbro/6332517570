syntax = "proto3";

package common.kin.authentication.v1;

option java_package = "com.kik.kin.authentication.model";
option go_package = "github.com/kikinteractive/xiphias-model-common/generated/go/kin/authentication/v1;authentication";

import "protobuf_validation.proto";
import "common_model.proto";
import "common/v1/model.proto";

// OfferId contains the id of any offer that's meant to be purchased on the Kin marketplace. Currently product id
// is supported.
message OfferId {

    oneof value {
        common.XiUuid product_id = 1;
    }
}

// An offer is the base info that the Kin marketplace expects for a product. An offer will be sent from the product
// service to the authentication service. The authentication service will embed this info into the offer JWT.
message Offer {

    OfferId offer_id = 1 [(kik.validation.field_validation) = { mandatory: true }];

    // Currently capped at 24 characters as per Kin JWT specs. Could increase in the future
    string offer_title = 2 [(kik.validation.field_validation) = {
        min_byte_length: 1
        max_byte_length: 24
    }];

    // Currently capped at 30 characters as per Kin JWT specs. Could increase in the future
    string offer_description = 3 [(kik.validation.field_validation) = {
        min_byte_length: 1
        max_byte_length: 30
    }];

    uint64 amount = 4 [(kik.validation.field_validation) = { mandatory: true }];
}

// An offer JWT is generated by the authentication service in response to a service requesting a JWT for a Kin offer.
// Currently, the product data service is the main user of this JWT.
message OfferJwt {

    // The id of an offer. An offer as an entity offered by Kik that has a Kin value and can be purchased. Currently,
    // product Ids are supported.
    OfferId id = 1 [(kik.validation.field_validation) = { mandatory: true }];

    // JWT generated by the authentication service for an offer.
    common.v1.XiJWT jwt = 2 [(kik.validation.field_validation) = { mandatory: true }];
}
